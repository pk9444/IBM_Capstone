# IBM Capstone Advanced Data Science Specialization 2023

## Project Goals

- To forecast/predict the daily highest stock price for RICs for the upcoming based on the historical data from January 2019 to 2023.
- Determine what features have the strongest impact on the daily highest price of an RIC with feature engineering.  
- Cross-validate the Random Forest Regressor from the Machine Learning stack and the LSTM Recurrent Neural Network from the Deep Learning stack for the time-series analysis.
- Deploy the best-performing model as an interactive flask-based web application that predicts the next 6-month average daily highest prices in real-time.
- Enable buyers and investors in informed business decisions through actionable insights generated by the forecasts of the Machine Learning/Neural Network model.


 ## Dataset 

 - Data Source: https://www.kaggle.com/datasets/luisgilch/stock-data-with-industry-information
 - Stock Data: historical data from January 2019 to September 2023 having the daily - highest price, opening price, closing price, and trading volume.  
 - Sector Data: sector-based information related to each RIC ticker such as company name, economic and business sector, industry name, etc.

## Data Product Full-Stack Lifecycle 

![IBM_Capstone_Implementation](https://github.com/pk9444/IBM_Capstone/assets/57378806/0440e104-32f6-432c-a7f1-d18bfff4e173)

## Most Important Features Impacting the Highest Stock Price

![feature_importance](https://github.com/pk9444/IBM_Capstone/assets/57378806/66cf58db-5165-4851-9f1d-52c91b26753f)

- The daily opening and closing prices have the strongest impact on the highest price for any given trading day.
- Quantitatively speaking, the opening and closing, together contribute to ~87%-88% importance in determining the highest stock price.
- The daily trading volume has a very low feature importance and hence, it does not add much information in forecasting the highest stock price.
- The daily return is a calculated feature derived as the `Opening Price - Closing Price` for any given day.
- The idea behind including a calculated feature is to avoid any potential multicollinearity that the opening and closing prices could cause.
- Based on the insights, two possible combinations of feature sets were recommended to predict the daily average highest price:
  - `{Opening Price, Closing Price}` (* throughout the iterative lifecycle, it was found out that this combination performs slightly better)
  - `{Opening Price, Closing Price, Daily Return}` 

## Model Building 

### Random Forest Regressor
![Random_Forest_Model drawio](https://github.com/pk9444/IBM_Capstone/assets/57378806/267b6a75-2b86-44f5-903e-c989943a17ac)


### LSTM Recurrent Neural Network 
![LSTM_Model_Diagram drawio](https://github.com/pk9444/IBM_Capstone/assets/57378806/02889886-5d70-4ad9-999f-69ef8eb3b727)

## Regression Testing Results 
![Regression_Testing](https://github.com/pk9444/IBM_Capstone/assets/57378806/41aa468f-72bd-4adf-bd52-4fa89fdaf366)

## Drawbacks of Regression in time-series forecasting 
- The Random Forest regressor fails to capture the temporal nature of time-series data while making predictions for any further timesteps.
- Consider a real-time example -> to predict the highest stock price of an RIC for the upcoming month - November 2023.
- Factors impacting November 2023:
  - The historical `Average Highest Price` for the past at least 6-12 months.
  - And the highest prices for the past 6-12 months in turn depend upon the `Average Opening Price`, `Average Closing Price` based on feature engineerin. 
-The Random forest, or any regressor for that instance, **fails to capture this very temporal or seasonal nature of a time-series historical data**.
- It only predicts based on the feature set for the current instance which are not available for the next months.
- Hence, this explains its bad performance on the Regression metrics and explains why it is not suitable for time-series forecasting. 






